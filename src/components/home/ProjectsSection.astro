---
import ProjectCard from './ProjectCard.astro';
import type { Project } from '../../content/home';

interface Props {
  projects: Project[];
}

const { projects } = Astro.props as Props;
---

<section class="section projects" id="projects" data-reveal>
  <div class="u-container section__heading">
    <div>
      <p class="u-title-overline">Featured Projects</p>
      <h2>Hybrid programmes bridging lab reality and cloud scale</h2>
    </div>
    <p>
      Core infrastructure programmes that keep my platform running: the GitOps
      Kubernetes platform, this portfolio, and the immutable operating system
      powering the nodes underneath.
    </p>
  </div>

  <div class="u-container projects__grid">
    {projects.map((project) => <ProjectCard project={project} />)}
  </div>
</section>

<style>
  .projects__grid {
    display: grid;
    gap: var(--space-lg);
    align-items: start;
    grid-auto-flow: row;
  }

  :global(.project-card) {
    position: relative;
    padding: var(--space-lg);
    border-radius: var(--radius-lg);
    border: 1px solid
      color-mix(in oklab, var(--color-border) 55%, transparent 45%);
    background: color-mix(in oklab, var(--color-surface) 88%, transparent 12%);
    box-shadow: var(--shadow-sm);
    display: grid;
    gap: var(--space-md);
    align-content: start;
  }

  :global(.project-card header) {
    display: grid;
    gap: var(--space-2xs);
  }

  :global(.project-card header h3) {
    font-size: var(--heading-lg);
  }

  :global(.project-card__content),
  :global(.project-card__footer),
  :global(.project-card__meta) {
    display: grid;
    gap: var(--space-sm);
  }

  :global(.project-card__tags) {
    list-style: none;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0;
    margin: 0;
  }

  :global(.project-card__tags li) {
    padding: 0.35rem 0.75rem;
    border-radius: var(--radius-sm);
    background: color-mix(
      in oklab,
      var(--color-primary) 12%,
      var(--color-surface)
    );
    color: var(--color-primary-strong);
    font-size: 0.75rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  :global(.project-card__footer ul),
  :global(.project-card__meta ul) {
    list-style: none;
    padding: 0;
    margin: 0;
    display: grid;
    gap: 0.55rem;
  }

  :global(.project-card__footer li),
  :global(.project-card__meta li) {
    color: var(--color-text);
  }

  :global(.project-card__link) {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: auto;
    font-size: 0.9rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  :global(.project-card--wide .project-card__link) {
    margin-top: 0;
  }

  :global(.project-card--wide) {
    grid-template-columns: repeat(12, minmax(0, 1fr));
    gap: clamp(var(--space-md), 2.6vw, var(--space-xl));
  }

  :global(.project-card--wide > *) {
    grid-column: span 12;
  }

  :global(.project-card--wide .project-card__content),
  :global(.project-card--wide .project-card__footer) {
    gap: clamp(var(--space-sm), 1.8vw, var(--space-lg));
    align-content: start;
  }

  :global(.project-card--wide .project-card__content > *),
  :global(.project-card--wide .project-card__footer > *) {
    display: grid;
    gap: var(--space-2xs);
  }

  @media (min-width: 960px) {
    .projects__grid {
      grid-template-columns: repeat(12, minmax(0, 1fr));
    }

    :global(.project-card--wide) {
      grid-column: span 12;
      align-items: start;
    }

    :global(.project-card--standard) {
      grid-column: span 6;
    }

    :global(.project-card--tall) {
      grid-column: span 6;
    }

    :global(.project-card--wide .project-card__content) {
      grid-column: span 7;
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    :global(.project-card--wide .project-card__footer) {
      grid-column: span 5;
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    :global(.project-card--wide .project-card__link) {
      grid-column: span 12;
      justify-self: start;
    }
  }

  @media (max-width: 720px) {
    :global(.project-card) {
      padding: var(--space-md);
    }
  }
</style>
