---
export interface Props {
    title: string;
    link: string;
    description?: string;
    technologies?: string[];
    index?: number;
}

const { title, link, description, technologies, index = 0 } = Astro.props;

// Calculate background position based on grid layout (2 columns)
const gridCol = index % 2;
const gridRow = Math.floor(index / 2);
const offsetX = gridCol * 300;
const offsetY = gridRow * 200;
---

<a href={link} target="_blank" rel="noopener noreferrer" class="project-card">
    <div class="project-visual" style={`--offset-x: -${offsetX}px; --offset-y: -${offsetY}px;`}>
        <!-- Shared background layer - each card shows different part -->
        <div class="project-background"></div>
        
        <!-- Project content -->
        <div class="project-preview">
            <div class="preview-content">
                <div class="preview-title">{title}</div>
                <div class="preview-label">Project Preview</div>
            </div>
        </div>

        <!-- Hover Overlay -->
        <div class="project-overlay">
            <div class="overlay-content">
                <h3 class="overlay-title">{title}</h3>
                {
                    description && (
                        <p class="overlay-description" set:html={description} />
                    )
                }
                {
                    technologies && technologies.length > 0 && (
                        <div class="overlay-technologies">
                            {technologies.map((tech) => (
                                <span class="technology-tag">{tech}</span>
                            ))}
                        </div>
                    )
                }
                <div class="overlay-cta">
                    View Project
                    <span class="cta-arrow">â†’</span>
                </div>
            </div>
        </div>
    </div>
</a>

<style>
    .project-card {
        display: block;
        text-decoration: none;
    }

    .project-visual {
        aspect-ratio: 4/3;
        background: linear-gradient(45deg, var(--brand-warm-blue-100), var(--brand-digital-lavender-100));
        margin-bottom: var(--size-6);
        overflow: hidden;
        position: relative;
        border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
        border: 1px solid var(--brand-warm-blue-300);
        box-shadow: var(--shadow-2), 0 2px 8px rgb(from var(--brand-mocha-mousse) r g b / 0.1);
        transition: all var(--animation-duration-slow);
        animation: blob 7s var(--ease-in-out-3) infinite;
    }

    .project-visual:hover {
        transform: scale(1.02);
        box-shadow: var(--shadow-4), 0 4px 16px rgb(from var(--brand-mocha-mousse) r g b / 0.15);
    }

    .project-background {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        opacity: 0.8;
        background: linear-gradient(45deg, 
            rgb(from var(--brand-mocha-mousse) r g b / 0.8) 0%, 
            rgb(from var(--brand-coral-primary) r g b / 0.8) 33%, 
            rgb(from var(--brand-digital-lavender-500) r g b / 0.8) 66%, 
            rgb(from var(--brand-accent-yellow) r g b / 0.8) 100%
        );
        background-size: 800% 800%;
        background-position: var(--offset-x) var(--offset-y);
        animation: liquidGradient 8s var(--ease-in-out-3) infinite;
    }

    .project-preview {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        z-index: 10;
        transition: opacity var(--animation-duration-slow);
    }

    .project-card:hover .project-preview {
        opacity: 0;
    }

    .preview-content {
        text-align: center;
        position: relative;
        z-index: 10;
    }

    .preview-title {
        font-size: var(--font-size-4);
        font-weight: var(--font-weight-7);
        margin-bottom: var(--size-2);
        color: white;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .preview-label {
        font-size: var(--font-size-0);
        color: white;
        font-weight: var(--font-weight-5);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    }

    .project-overlay {
        position: absolute;
        inset: 0;
        background: rgb(from white r g b / 0.95);
        opacity: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 75ms;
    }

    .project-card:hover .project-overlay {
        opacity: 1;
    }

    .overlay-content {
        text-align: center;
        color: var(--brand-mocha-800);
        padding: var(--size-4);
    }

    @media (min-width: 640px) {
        .overlay-content {
            padding: var(--size-8) var(--size-6);
        }
    }

    .overlay-title {
        font-size: var(--font-size-3);
        font-weight: var(--font-weight-7);
        margin-bottom: var(--size-3);
        background: linear-gradient(135deg, var(--brand-mocha-mousse) 0%, var(--brand-coral-primary) 50%, var(--brand-cool-contrast) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    @media (min-width: 640px) {
        .overlay-title {
            font-size: var(--font-size-4);
            margin-bottom: var(--size-4);
        }
    }

    .overlay-description {
        color: var(--brand-mocha-700);
        font-size: var(--font-size-00);
        margin-bottom: var(--size-4);
        line-height: var(--font-lineheight-4);
    }

    @media (min-width: 640px) {
        .overlay-description {
            font-size: var(--font-size-0);
            margin-bottom: var(--size-6);
        }
    }

    .overlay-technologies {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: var(--size-1);
        margin-bottom: var(--size-4);
    }

    @media (min-width: 640px) {
        .overlay-technologies {
            gap: var(--size-2);
            margin-bottom: var(--size-6);
        }
    }

    .technology-tag {
        padding: var(--size-1) var(--size-2);
        background: var(--brand-mocha-100);
        color: var(--brand-mocha-700);
        font-size: var(--font-size-00);
        border-radius: var(--radius-round);
        border: 1px solid var(--brand-mocha-200);
        font-weight: var(--font-weight-5);
    }

    @media (min-width: 640px) {
        .technology-tag {
            padding: var(--size-1) var(--size-3);
        }
    }

    .overlay-cta {
        display: inline-flex;
        align-items: center;
        gap: var(--size-2);
        color: var(--brand-mocha-600);
        font-size: var(--font-size-00);
        font-weight: var(--font-weight-5);
        background: rgb(from var(--brand-mocha-100) r g b / 0.5);
        padding: var(--size-2) var(--size-3);
        border-radius: var(--radius-round);
        border: 1px solid rgb(from var(--brand-mocha-200) r g b / 0.5);
    }

    @media (min-width: 640px) {
        .overlay-cta {
            font-size: var(--font-size-0);
            padding: var(--size-2) var(--size-4);
        }
    }

    .cta-arrow {
        transition: transform var(--animation-duration-normal);
    }

    .project-card:hover .cta-arrow {
        transform: translateX(var(--size-1));
    }
</style>